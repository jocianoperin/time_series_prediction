# File: compare_barcodes.py

from pathlib import Path

# ====================================================
# 1) INSIRA AQUI SUA LISTA DE CÓDIGOS DE BARRAS
# ====================================================
OLD_BARCODES = [
    "7896111419779", "7898414311118", "7896012101322", "7891149105502", "7896362700107", "7891079001028", "7891024037973", "7896183901806", "7896569400831", "7896275980801", "7896011127057", "7898215151784", "7891000250174", "7898295300584", "7896111426227", "7896291410016", "7896022086374", "7898538751531", "7893000394209", "7898240320070", "7898180570160", "7891000251614", "7896183901844", "7896004006482", "7896232800371", "7891999010995", "7897938901089", "7896090400041", "7896026800860", "7897829906063", "7896419431015", "7896098905906", "7891149103300", "7898295301444", "7896202891903", "7891132019724", "7896036098639", "7896098901113", "7898994712510", "7898215152002", "7898939720068", "7898958139018", "7896419431053", "7896183900861", "7898920495029", "7896090400027", "7897517209261", "7898318160812", "7894900910018", "7896295330235", "7896987130068", "7891022640007", "7898994541431", "7898910365127", "7891000251133", "7622300119652", "7896011103518", "7898969133074", "7896017411303", "7891149103041", "7898972064013", "7896104998540", "7891021006125", "7896735115576", "7896022200800", "7896038306039", "7622300861957", "7898032910120", "7896022207076", "7896098900741", "7896399300028", "7896274800148", "7896274803682", "7896183901790", "7896022201906", "7898994000082", "7896295386911", "7896026800211", "7891000284230", "7896735114876", "7896735115378", "7891000352175", "7896337300035", "7891150081147", "7896011106892", "7896183900298", "7898065600180", "7896360600737", "7896018900035", "7896050200124", "7896104996492", "7891164016319", "7897829900108", "7894904955879", "7898902207077", "7898394800015", "7892840816209", "7896022203849", "7898374630991", "7896202820200", "7897252400022", "7896183906269", "78937765", "7896038321032", "7896048200105", "7500435154420", "7896807499542", "7896045102495", "7896760400029", "7891000251539", "7896022204181", "7896026800631", "7896022207113", "7896337301742", "7896337300295", "7891962051345", "7896738100227", "78908901", "7891000284933", "7891150060289", "7896327511984", "7896012101315", "7894000050034", "7898414310012", "7891149104932", "7891080404887", "7896202891415", "7891024134610", "7896461300321", "7894900701517", "7891024132371", "7896419713852", "7896292340503", "7898562800793", "7896295601625", "7896011108032", "7896183905354", "7891000061190", "7894900027020", "7897191400015", "7894900014211", "7896026800112", "7898949217190", "7896104996393", "7898324005176", "78941151", "7894900031515", "7896036090244", "7892840255442", "7896020902164", "7896275970611", "7896275900953", "7898960419443", "7891035524189", "7898295301437", "7896026800723", "7891080404870", "7896337300165", "7891132019717", "7896011127088", "7896232800395", "7896102500608", "7896798500524", "7896504305061", "78939745", "7894900031607", "7891024036839", "7896183904746", "7898185261445", "7896327514169", "7894900027334", "7891040031757", "7896461300215", "7896017411006", "7896202891484", "7897938903069", "7898963388012", "7891350034646", "7896022201944", "7891528038001", "7896275920265", "7891150060272", "7896306612817", "7896111426210", "7891132082568", "7891132001101", "7500435154437", "7891022100372", "7896478900118", "7896011107073", "7896111421550", "7896441000012", "7891149104949", "7896830421268", "7891962051338", "7892840800000", "7896004008479", "7891079000229", "78938571", "7896798500722", "7891242151673", "7891025110668", "7898374661384", "7891040031764", "7896183903220", "7891149100019", "7896104993941", "7898065334948", "7896104998557", "7898969133050", "7622300990701", "7896337301971", "7891008168853", "7896490290693", "7894900051513", "7896295601649", "7898082522632", "7896275980870", "7898910365134", "7898994000075", "7898621151118", "7894900011609", "7896273400011", "7897829900092", "7891132082407", "7896011106083", "7895800201503", "7898938087018", "7898941720018", "7891024027523", "7893000084360", "7891079001011", "7896360600669", "7898913771642", "7896274804344", "7891000053508", "7892840815912", "7896026850155", "7896978201265", "7896022086404", "7896001004511", "7702018118823", "7896327511342", "7896011107851", "7896408432719", "7896036000823", "7896083800247", "7898620010836", "7891149440801", "7896490290631", "7894000030470", "7898422746759", "7891167021013", "7896011107868", "7896017457813", "7897938901065", "7896011105871", "78936911", "7891528030142", "7898406510062", "7897040800041", "7896098901939", "7891040320622", "7896005806029", "7896183900878", "78930193", "7896020901075", "7798018850566", "7896274806171", "7891024134702", "7896327514190", "7896022086183", "7898621151484", "7896275981150", "7898032918157", "7891098000972", "7896274803996", "7897075206443", "7896011108926", "7896399300202", "7896337300110", "7896022086213", "7896275960193", "7896461300338", "7896183903213", "7896275970628", "7896022200794", "7896461300017", "7896275920678", "7896337310300", "7894900010398", "7896022201937", "7896291410023", "7896380000012", "7896054719202", "7896490290723", "7891040222476", "7896348840049", "7896252206139", "7896274800124", "7896275983192", "7891000029329", "7898944499188", "7896022086206", "7896011127040", "7897436004572", "7896183910396", "7898215151807", "7898240320179", "7896001045446", "7896183910761", "7898094760640", "7896408432726", "7891991015868", "7896183900533", "7896275900571", "7896232800494", "7896504305078", "7896022203139", "7891132000449", "7891008114003", "7896275970635", "78602731", "7896098904732", "7896327514114", "7891132082285", "7896202810768", "7898185261377", "7896183902094", "7896089016215", "7896461300260", "7896011127064", "7891132008698", "78939363", "7898016290828", "7891079012987", "7896295600215", "7898130150114", "7891079000212", "7898240950086", "7891132082421", "7896260012128", "7896490290686", "7896011127422", "7896434920778", "7898944499096", "7896478930009", "7891079006009", "7896399300219", "7891149101528", "7896274805037", "7898915578096", "7892840821203", "7891149100002", "7896183901097", "7896275960575", "7896275970680", "7891167021020", "7896022201890", "7891150059849", "7891030300207", "7896260012098", "7896183904241", "78933873", "7891107101621", "7897938900662", "7896098900710", "7891024132005", "7896327511335", "7896111421536", "7896111426234", "7898910365356", "7891022101003", "7896111425992", "7896026839242", "7898172660183", "7891242151680", "7896011103747", "7894904571956", "7898921359009", "7896798500616", "7898172660725", "7897436005180", "7896337300141", "7891150059870", "7894900593709", "7896022056520", "7896022086459", "7896295600017", "7896327510956", "7898012650053", "7898130150671", "7896005806012", "7896275900977", "7891150045255", "7896102502183", "7896022086190", "7896015975609", "7891055605806", "7896337300219", "7896098900109", "7896360600676", "7897938903052", "7896275970185", "7897517206086", "7896007545094", "7896327512509", "7891164006860", "7897436006835", "7894900031706", "7897938901072", "7898908236552", "7896691103402", "7891999340108", "7898039253848", "7898223321209", "7622300807399", "7896380000388", "7898027313066", "7891164005245", "7896011104157", "7891024026458", "7896275920838", "7896111422434", "7898027315282", "7896183901646", "7897664171701", "7897001010014", "7896295600024", "7898289870024", "7898927536015", "7894900583700", "7896183900465", "7896004401843", "7891051015210", "7896461300345", "7896022203191", "7896045318360", "7891098000057", "7898568860180", "7891323075287", "7891000325131", "7622300861148", "7891000462300", "7509546667638", "7891000249239", "7896408433419", "7898024395232", "7896275960544", "7897426020117", "7896327512967", "7896015910020", "7896590802123", "7896745800745", "7896036096673", "7622300861872", "7896102504361", "7896735115330", "7896274800223", "7896275900984", "7896508200041", "7896011103754", "7896015960100", "7896104996409", "7891991010023", "78912359", "7896508200034", "7891010793463", "7898994541417", "7896275960896", "7891040031740", "7897436004756", "7896098900987", "7622210411501", "7896256602111", "7896275950316", "7898920238060", "7898414311125", "7898927536084", "7896398901134", "7896098900253", "7896275970802", "7896111422403", "7896011107165", "7891000241356", "7896448000800", "7896022200763", "7896011105505", "7898927536053", "7891150049871", "7896813600239", "7896009718113", "7896380000029", "7897824712898", "7896022086220", "7896274804337", "7896337301186", "7845169457868", "7891164020149", "7891242062443", "7896490290679", "7896011108797", "7896005800676", "7894900010220", "7898904564369", "7890807260034", "7896104996447", "7898094760978", "7898910365295", "7896017413208", "7898409951664", "7896183900991", "7891149200504", "7622300861261", "7896275940355", "7896504305313", "7891079000205", "7896478900026", "7896275970772", "7896279600422", "7896038388059", "7896017414304", "7896275970529", "7896461300246", "7896015960209", "7891132082346", "7896104998311", "7896011129358", "7896022200534", "7622300861223", "7898245990063", "7898944499157", "7896337300745", "7896275960131", "7896111426005", "7897003410171", "7896380000111", "78930230", "7896011106885", "7891738019005", "7891021006934", "7891991010542", "7896183910754", "7891107111934", "7898289870048", "7891079006016", "7891999100047", "7896007545100", "7895800304211", "7896589515201", "7898568860036", "7896022201913", "7891149103102", "7896011126739", "7896354816946", "7898185261667", "7896546110050", "78937680", "7898953148169", "7896461300314", "7896011127033", "7897829905066", "7896813600246", "7896348841763", "7896098900215", "7896275970246", "7891022639001", "7897436005197", "7898374633008", "7896051020158", "7896183901257", "7896224836098", "7891000464908", "7898621150708", "7506339363883", "7896183910556", "7896026850148", "7896011102597", "7896100900011", "7891079013038", "7896017413000", "7896252210037", "7896813600291", "7891528038568", "7898908236354", "7897517209025", "7896354100861", "7897517209643", "7896104996454", "7891150064331", "7896022086411", "7898239260745", "7896337302022", "7891021006071", "7891022638004", "7898568860029", "7896017413307", "7897001040028", "7894900151510", "7891528038612", "7896275980290", "78912366", "7896327514121", "7896490290648", "7896011127071", "7896083800025", "7896337301865", "7896691102641", "7894904271528", "7896399300196", "7891150060296", "7896202892023", "7896461300307", "7896760400425", "7896022202101", "7896098902486", "7891150049895", "7891035524271", "7894650014288", "7894900010015", "78931251", "7896105177050", "7896327514152", "7896183901783", "7896022086381", "7896036090619", "7896183901264", "7891515474133", "7891962053189", "7896529610102", "7896489700028", "7898045700336", "7793100111143", "77940131", "7896104995280", "7896017455505", "7896419422013", "7898307570875", "7896045102501", "7891149010103", "7898621152467", "7891097013003", "7896279600507", "7891149103119", "7891515474126", "7891150059924", "7894900011715", "7892300030633", "7896354100939", "7896183909123", "7896490290655", "78939318", "7891132082384", "7891030003016", "7896399300332", "7896411800178", "7896098901090", "7896461300413", "7898929966100", "7896274804320", "7897938902376", "7896427000012", "7896902209114", "7509546672021", "7896026844901", "7896279600538", "7894900911510", "7891150072152", "7894900050011", "7896012101339", "7896327514237", "7896274800131", "7896011127293", "7898568860647", "7897517206284", "7896260012012", "7891173021793", "7896022075040", "7896102509410", "7622300807283", "7897395040437", "7898902207084", "7622210596413", "7896275980733", "7898374660165", "7896022207090", "7896183903176", "7891008168884", "7896098900277", "7891150072138", "7891150059887", "7898414312221", "7622300861308", "7896360600744", "7891010973483", "7896022018320", "7896275920401", "7896337300189", "7896327512974", "7896419727637", "7896011127019", "7896508200010", "7891164006853", "7896036099117", "7891150064317", "7898041020131", "7891040001316", "7896011103730", "7893590204339", "7896275970383", "7896461300239", "7896275980498", "7622300861919", "7896011107301", "7896183903596", "7896704100015", "7898289870086", "7896337301575", "7896508200027", "7896275970574", "7891528029498", "7896017455406", "7896183905514", "7896011129396", "7891030300306", "7898065334818", "7891164006846", "7898927536022", "7896275921064", "7622300119621", "7892840816193", "7898280080149", "7622300861186", "7894904003495", "7896275920593", "78936478", "7895800304228", "7891150066571", "7898235672191", "7898608572769", "7896011104126", "7898240320469", "7896434921058", "7896490290587", "7894900030013", "7891150029002", "7896011106557", "7891150060302", "7891132019274", "7896295600161", "7898948023853", "7891021002127", "7891149010509", "7892300000698", "7896022207106", "7896011107035", "7891999904805", "7896275970406", "7896111419762", "7896089010916", "7894900034219", "7896022203771", "7896017413109", "7895800430002", "7891000338087", "7898296430044", "7891991001342", "7891150056916", "7896451911575", "7891098000330", "7896461300420", "7896011108025", "7896098904671", "7896015922054", "7896104998724", "7896342902200", "7896275980504", "7898172662163", "7898910365011", "7898621151934", "7898171880018", "7897021510006", "7896260012104", "7896337300127", "7898172660107", "7898232000072", "7897048001402", "7898240320100", "7896337301193", "7896020904090", "7898944499164", "7896012104941", "7898374660011", "7896020901082", "7896546113327", "7894900027327", "7896001001152", "7894904500383", "7896026800709", "7896026800754", "7896022075408", "7896083800018", "7896274800018", "7894900061512", "7896212500192", "7896327511519", "7896111419786", "7897040800034", "7896337300059", "7898026081911", "7896183901776", "7894900027037", "7896360602113", "7891738019098", "7896978201258", "7894900681000", "7891999011039", "7898910365028", "7896020900269", "7896011107103", "7896072383195", "7898406510239", "7891024177846", "7891024135310", "7898963388043", "7896111421543", "7891962054117", "7898915414899", "7896260012203", "7896478900019", "7896045318377", "7898235671095", "7891024110508", "7896490290709", "7896202891491", "7896360600720", "7894900011517", "7896084909024", "7896337300233", "7897664171732", "7896011129341", "7898235671101", "7896337300103", "7896735115453", "7891024024386", "7896275960582", "7898963388067", "7898911055034", "7896183901325", "7896011108780", "7896511200014", "7896104993668", "7894900093292", "7896015910006", "7898960419412", "7897664170735", "7896275970277", "7898087260010", "7896183900342", "7897517209544", "7896007547654", "7896337300196", "7896011129334", "7898027313158", "7896327514312", "7896098900208", "7896022203146", "7897426020124", "7896183903077", "7896183902261", "7898562801622", "7898621151958", "7896490290730", "7896022201852", "7896048200051", "78939301", "7891991010900", "7896090400010", "7896098900222", "7896451911582", "7891149102853", "7891991010436", "7897040800010", "7896011108803", "7896275970796", "7896399300073", "7896508200119", "7896100013018", "7897172500192", "7896183905507", "7891080400063", "7891000460207", "7891164027681", "7896327511328", "7891022637007", "7894900027013", "7898915414844", "7896735115507", "7896183903244", "7891962037028", "7896011107363", "7896337300332", "7896408432313", "7896000593672", "7896001045149", "7897252400015", "7896292343702", "7895800309780", "7896011103761", "7891164005726", "7896026839259", "7891164005320", "7896295600079", "7891000248768", "7896098900239", "7896098901724", "7896015910518", "7892840255541", "7891098000040", "7891962054100", "7891098000354", "7896036097816", "7898552950026", "7896461300048", "7896275970239", "7894900911602", "7896022200756", "7896327514145", "7891132019281", "7896275920579", "7894900054217", "7897001010502", "7896011108810", "7896015940010", "7896327514138", "7898954162010", "7896015960001", "7891515434311", "7896183911577", "7896007972104", "7891024132128", "7894900015119", "7896011127026", "7896461300109", "7896337300158", "7896489700189", "7892300030015", "7898969133036", "7891008116632", "7896490290662", "7891132019403", "7896001004504", "7896011101880", "7896448006666", "7896017455307", "7894321722016", "7893000079298", "7896490290617", "7896045503452", "7896019206785", "7896274804313", "7891738018954", "7896011103532", "7896500400432", "7891021001946"
]

# ====================================================
# 2) CONFIGURAÇÕES DE CAMINHOS
# ====================================================
FOLDER_PATH = Path("/home/jociano/Downloads/data/Market 2")    # pasta com arquivos <barcode>_<categoria>.csv
OUTPUT_DIR  = Path("/home/jociano/Downloads/data/Market 2")          # onde salvar os arquivos de saída

def main():
    # Conjuntos
    antigos = set(OLD_BARCODES)
    atuais  = {f.name.split("_", 1)[0] for f in FOLDER_PATH.iterdir() if f.is_file()}

    # Diferenças
    faltantes = sorted(antigos - atuais)
    extras     = sorted(atuais - antigos)

    # Grava arquivos de saída
    OUTPUT_DIR.mkdir(parents=True, exist_ok=True)
    (OUTPUT_DIR / "missing_in_folder.txt").write_text("\n".join(faltantes))
    (OUTPUT_DIR / "extra_in_folder.txt").write_text("\n".join(extras))

    # Resumo
    print(f"Códigos NA LISTA mas NÃO NA PASTA: {len(faltantes)} → missing_in_folder.txt")
    print(f"Códigos NA PASTA mas NÃO NA LISTA: {len(extras)} → extra_in_folder.txt")

if __name__ == "__main__":
    main()
